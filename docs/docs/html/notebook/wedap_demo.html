<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WEDAP Demo &mdash; wedap  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="wekap.kinetics module" href="../wekap.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            wedap
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wedap_modules.html">wedap modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdap_modules.html">mdap modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wekap_modules.html">wekap modules</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">WEDAP Demo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Basic-wedap-usages-with-WESTPA-H5-data">Basic wedap usages with WESTPA H5 data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#MDAP:-plotting-directly-from-standard-MD-data">MDAP: plotting directly from standard MD data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Advanced-wedap-examples">Advanced wedap examples</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">wedap</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">WEDAP Demo</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebook/wedap_demo.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="WEDAP-Demo">
<h1>WEDAP Demo<a class="headerlink" href="#WEDAP-Demo" title="Permalink to this heading"></a></h1>
<hr class="docutils" />
<p><strong>WEDAP</strong> : <strong>W</strong>eighted <strong>E</strong>nsemble <strong>D</strong>ata <strong>A</strong>nalysis and <strong>P</strong>lotting (pronounced we-dap)</p>
<p><p><img alt="wedap logo" class="no-scaled-link" src="../_images/wedap_logo4.png" style="width: 200px;" /></p>
</p><p>Here, we will go through many examples of how to use the Python API or the command line for various types of plots using <code class="docutils literal notranslate"><span class="pre">wedap</span></code> and <code class="docutils literal notranslate"><span class="pre">mdap</span></code>.</p>
<p>Note that the CLI will tend to format and label more things for you, while the API starts as more of a “blank slate” format wise since the options can be more easily adjusted.</p>
<p>Before using the <code class="docutils literal notranslate"><span class="pre">wedap</span></code> API, make sure to import the following:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">wedap</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># optionally apply default wedap matplotlib style sheet</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Basic-wedap-usages-with-WESTPA-H5-data">
<h2>Basic wedap usages with WESTPA H5 data<a class="headerlink" href="#Basic-wedap-usages-with-WESTPA-H5-data" title="Permalink to this heading"></a></h2>
<hr class="docutils" />
<p>Note that if the command line can generate the example plot, the shell command will be shown before the Python code. Also note that the command line arguments will all use a hyphen to separate multi-word arguments while in Python these will be represented by underscores, e.g. <code class="docutils literal notranslate"><span class="pre">--data-type</span></code> or <code class="docutils literal notranslate"><span class="pre">--p-units</span></code> as command line arguments will be equivalently in Python <code class="docutils literal notranslate"><span class="pre">data_type</span></code> or <code class="docutils literal notranslate"><span class="pre">p_units</span></code>.</p>
<p>Running <code class="docutils literal notranslate"><span class="pre">wedap</span> <span class="pre">-h</span></code> or <code class="docutils literal notranslate"><span class="pre">wedap</span> <span class="pre">--help</span></code> on the command line is very useful for a summary of the command options, along with some basic usage examples.</p>
<p align="left"><p><img alt="CLI --help" class="no-scaled-link" src="../_images/cli2.png" style="width: 600px;" /></p>
</p><p>To use the GUI, simply run <code class="docutils literal notranslate"><span class="pre">wedap</span></code> in the command line with no arguments and the popup should look something this:</p>
<p align="left"><p><img alt="GUI" class="no-scaled-link" src="../_images/gui3_postproc.png" style="width: 550px;" /></p>
</p><p>Reading through the GUI options and their associated descriptions can also be useful to find out more about them.</p>
<p>We note that wedap is compatible with multiple HDF5 data files passed into the <code class="docutils literal notranslate"><span class="pre">-W</span></code> or <code class="docutils literal notranslate"><span class="pre">-h5</span></code> flag, which corresponds to passing a list instead of a string into the <code class="docutils literal notranslate"><span class="pre">h5</span></code> argument in Python. For simplicity we only use a single file for our examples.</p>
<section id="Example-1:-Evolution-Plot">
<h3>Example 1: Evolution Plot<a class="headerlink" href="#Example-1:-Evolution-Plot" title="Permalink to this heading"></a></h3>
<p>This is a classic plot of the evolution of a WE simulation, plotting the probability distribution on the X axis as you progress through each iteration of the WE simulation on the Y axis. The colorbar is showing the probability values of each bin in the histogram. The probability values are derived from the raw data count values of the multiple segments in each WE iteration in the west.h5 file, weighted by each segment weight. This weighted histogram is normalized and shown on an inverted natural
log scale: <span class="math notranslate nohighlight">\(-\ln(\frac{P(x)}{P(max)})\)</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W p53.h5 --data-type evolution --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot;
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;evolution&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;WE Iteration&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9e3293d6bf454793b1def4f273166594", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(10.097222222222232, 0.5, &#39;WE Iteration&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_9_2.png" src="../_images/notebook_wedap_demo_9_2.png" />
</div>
</div>
<p>We could also just directly place the plot formatting arguments into <code class="docutils literal notranslate"><span class="pre">wedap.H5_Plot()</span></code>, we can also plot the other dimension of the progress coordinate by setting <code class="docutils literal notranslate"><span class="pre">Xindex=1</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W p53.h5 --data-type evolution -X pcoord -Xi 1 --xlabel &quot;End-to-end Distance ($\AA$)&quot;
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;evolution&quot;</span><span class="p">,</span> <span class="n">Xname</span><span class="o">=</span><span class="s2">&quot;pcoord&quot;</span><span class="p">,</span> <span class="n">Xindex</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
              <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;End-to-end Distance ($\AA$)&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;WE Iteration&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "11959c3e73f84b3095fb71914691fdd4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_12_1.png" src="../_images/notebook_wedap_demo_12_1.png" />
</div>
</div>
<p>Alternatively we can use the mpl object-based interface, this offers more flexibility when making more complex plots, examples of which will be demonstrated later along in this notebook.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># instantiate the wedap H5_Plot class</span>
<span class="n">wedap_obj</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;evolution&quot;</span><span class="p">)</span>
<span class="c1"># run the main plotting method</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="c1"># call the mpl axes object (ax) from wedap class object and format</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;WE Iteration&quot;</span><span class="p">)</span>
<span class="c1"># the fig object can also be called</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Evolution Plot&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "905c50ed59364e11bbf1d52a8a883bb6", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.45, 1.02, &#39;Evolution Plot&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_14_2.png" src="../_images/notebook_wedap_demo_14_2.png" />
</div>
</div>
<p>We can break the process down further to access the data being passed:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># run the wedap H5_Pdist class main method</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Pdist</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;evolution&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pdist</span><span class="p">()</span>

<span class="c1"># pass datasets to H5_Plot</span>
<span class="n">wedap_obj</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># call the mpl axes object (ax) from wedap class object and format</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;WE Iteration&quot;</span><span class="p">)</span>
<span class="c1"># the fig object can also be called</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Evolution Plot&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c1209e85922b40ea8c65fa53ca4001fc", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.45, 1.02, &#39;Evolution Plot&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_16_2.png" src="../_images/notebook_wedap_demo_16_2.png" />
</div>
</div>
</section>
<section id="Example-2:-1D-Probability-Distribution">
<h3>Example 2: 1D Probability Distribution<a class="headerlink" href="#Example-2:-1D-Probability-Distribution" title="Permalink to this heading"></a></h3>
<p>You can also make simple 1D plots for a single iteration <code class="docutils literal notranslate"><span class="pre">--data-type</span> <span class="pre">instant</span></code> || <code class="docutils literal notranslate"><span class="pre">data_type='instant'</span></code> or for the average of a range of iterations <code class="docutils literal notranslate"><span class="pre">--data-type</span> <span class="pre">average</span></code> || <code class="docutils literal notranslate"><span class="pre">data_type='average'</span></code>. Here we show the average probability distribution for the entire range of WE iterations in the input <code class="docutils literal notranslate"><span class="pre">west.h5</span></code> file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W p53.h5 -dt average --plot-mode line --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot;
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "06089cb5f8f045589315bd02e05dd37a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 7.222222222222218, &#39;Heavy Atom RMSD ($\\AA$)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_20_2.png" src="../_images/notebook_wedap_demo_20_2.png" />
</div>
</div>
</section>
<section id="Example-3:-2D-Probability-Distribution">
<h3>Example 3: 2D Probability Distribution<a class="headerlink" href="#Example-3:-2D-Probability-Distribution" title="Permalink to this heading"></a></h3>
<p>We can also make probability distributions using two datasets, first we can try this with just our two dimensional progress coordinates. Note that you can set the progress coordinate or any aux dataset index using <code class="docutils literal notranslate"><span class="pre">Xindex</span></code>, <code class="docutils literal notranslate"><span class="pre">Yindex</span></code>, and <code class="docutils literal notranslate"><span class="pre">Zindex</span></code>. This can be useful for multi-dimensional progress coordinates, but also for multi-dimensional auxiliary data.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W p53.h5 --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot; -dt average  \
        -y pcoord -yi 1 --ylabel &quot;End-to-end Distance ($\AA$)&quot;
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">Xindex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;pcoord&quot;</span><span class="p">,</span> <span class="n">Yindex</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;End-to-end Distance ($\AA$)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "71fab1b5da794652858377acee17ac72", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(31.347222222222232, 0.5, &#39;End-to-end Distance ($\\AA$)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_24_2.png" src="../_images/notebook_wedap_demo_24_2.png" />
</div>
</div>
<p>Now we can try it with one progress coordinate and an auxiliary dataset saved during the WE simulation (or it could have been calculated post-simulation (e.g. using <code class="docutils literal notranslate"><span class="pre">w_crawl</span></code>)):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W p53.h5 --xlabel &quot;End-to-end Distance ($\AA$)&quot; -xi 1 -dt average  \
        -y dihedral_11 --ylabel &quot;Dihedral 11 ($\degree$)&quot;
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">Xindex</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;dihedral_11&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;End-to-end Distance ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Dihedral 11 ($\degree$)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c2a17dd9d70f435e8a574cefcf3bbecc", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(-1.527777777777768, 0.5, &#39;Dihedral 11 ($\\degree$)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_27_2.png" src="../_images/notebook_wedap_demo_27_2.png" />
</div>
</div>
</section>
<section id="Example-4:-3D-Scatter-Plot">
<h3>Example 4: 3D Scatter Plot<a class="headerlink" href="#Example-4:-3D-Scatter-Plot" title="Permalink to this heading"></a></h3>
<p>What if you don’t want to show the probability axis? Well, you can also just show how three different datasets are related in a 3D scatter plot. Here we can put two different aux datasets on the X and Y axes and we can set the colorbar to show the progress coordinate values in comparison:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W p53.h5 --xlabel &quot;Dihedral 11 ($\degree$)&quot; -x dihedral_11  -dt average  -y dihedral_12 --ylabel &quot;Dihedral 12 ($\degree$)&quot; -z pcoord --cbar-label &quot;Heavy Atom RMSD ($\AA$)&quot; -pm scatter3d
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;scatter3d&quot;</span><span class="p">,</span>
              <span class="n">Xname</span><span class="o">=</span><span class="s2">&quot;dihedral_11&quot;</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;dihedral_12&quot;</span><span class="p">,</span> <span class="n">Zname</span><span class="o">=</span><span class="s2">&quot;pcoord&quot;</span><span class="p">,</span>
              <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span>
              <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Dihedral 11 ($\degree$)&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Dihedral 12 ($\degree$)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "83b8cf91542a49de9b3bbb027b770218", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_31_1.png" src="../_images/notebook_wedap_demo_31_1.png" />
</div>
</div>
</section>
<section id="Example-5:-Joint-Plot-with-Multiple-Extra-Features">
<h3>Example 5: Joint Plot with Multiple Extra Features<a class="headerlink" href="#Example-5:-Joint-Plot-with-Multiple-Extra-Features" title="Permalink to this heading"></a></h3>
<p>Here, I want to demonstrate some of the additional features available by making a more complicated joint plot. This is using a contour plot instead of a histogram, as set by <code class="docutils literal notranslate"><span class="pre">--plot-mode</span> <span class="pre">contour</span></code> || <code class="docutils literal notranslate"><span class="pre">plot_mode='contour'</span></code>, there is also custom colormapping (<code class="docutils literal notranslate"><span class="pre">--cmap</span></code>), probability units (<code class="docutils literal notranslate"><span class="pre">--p-units</span></code>), iteration ranges (<code class="docutils literal notranslate"><span class="pre">--first-iter</span></code>, <code class="docutils literal notranslate"><span class="pre">--last-iter</span></code>), probability limits (<code class="docutils literal notranslate"><span class="pre">--pmin</span></code>, <code class="docutils literal notranslate"><span class="pre">--pmax</span></code>), plot style (<code class="docutils literal notranslate"><span class="pre">--style</span></code>), data smoothing (<code class="docutils literal notranslate"><span class="pre">--smoothing-level</span></code>), and plot limits
(<code class="docutils literal notranslate"><span class="pre">--xlim</span></code>, <code class="docutils literal notranslate"><span class="pre">--ylim</span></code>).</p>
<p>Available <code class="docutils literal notranslate"><span class="pre">--plot-mode</span></code> || <code class="docutils literal notranslate"><span class="pre">plot_mode</span></code> options: * <code class="docutils literal notranslate"><span class="pre">line</span></code> – plot 1D lines. * <code class="docutils literal notranslate"><span class="pre">hist</span></code> – plot histogram (default). * <code class="docutils literal notranslate"><span class="pre">hist_l</span></code> – plot histogram and contour lines. * <code class="docutils literal notranslate"><span class="pre">contour</span></code> – plot contour levels and lines. * <code class="docutils literal notranslate"><span class="pre">contour_f</span></code> – plot contour levels only. * <code class="docutils literal notranslate"><span class="pre">contour_l</span></code> – plot contour lines only. * <code class="docutils literal notranslate"><span class="pre">scatter3d</span></code> – plot 3 datasets in a scatter plot.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W p53.h5 --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot; -xi 0  -dt average  -y dihedral_11 --ylabel &quot;Dihedral 11 ($\degree$)&quot; --joint-plot -pm contour_f --cmap gnuplot_r --style ggplot --p-units kcal --first-iter 3 --last-iter 15 --pmin 1 --pmax 10 --smoothing-level 1 --xlim -1 7 --ylim -180 180
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if there is alot of plotting choices, it can be easier to just put it all into a dictionary</span>
<span class="n">plot_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;h5&quot;</span> <span class="p">:</span> <span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                <span class="s2">&quot;plot_mode&quot;</span> <span class="p">:</span> <span class="s2">&quot;contour_f&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Xname&quot;</span> <span class="p">:</span> <span class="s2">&quot;pcoord&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Yname&quot;</span> <span class="p">:</span> <span class="s2">&quot;dihedral_11&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cmap&quot;</span> <span class="p">:</span> <span class="s2">&quot;gnuplot_r&quot;</span><span class="p">,</span>
                <span class="s2">&quot;jointplot&quot;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;p_units&quot;</span> <span class="p">:</span> <span class="s2">&quot;kcal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;first_iter&quot;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s2">&quot;last_iter&quot;</span> <span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                <span class="s2">&quot;p_min&quot;</span> <span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s2">&quot;p_max&quot;</span> <span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="s2">&quot;smoothing_level&quot;</span> <span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                <span class="c1"># the input plot_options kwarg dict is also parsed for matplotlib formatting keywords</span>
                <span class="s2">&quot;xlabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ylabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Dihedral 11 ($\degree$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;xlim&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
                <span class="s2">&quot;ylim&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span>
                <span class="p">}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;ggplot&quot;</span><span class="p">)</span>
<span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="o">**</span><span class="n">plot_options</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># save the resulting figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;wedap_jp.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "df7b048614514d1cbd0a38b8f6a9b7e9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_35_1.png" src="../_images/notebook_wedap_demo_35_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># change style back to wedap default</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="MDAP:-plotting-directly-from-standard-MD-data">
<h2>MDAP: plotting directly from standard MD data<a class="headerlink" href="#MDAP:-plotting-directly-from-standard-MD-data" title="Permalink to this heading"></a></h2>
<hr class="docutils" />
<p><strong>MDAP</strong> : <strong>M</strong>olecular dynamics <strong>D</strong>ata <strong>A</strong>nalysis and <strong>P</strong>lotting (pronounced em-dap)</p>
<p>Similarly to <code class="docutils literal notranslate"><span class="pre">wedap</span></code>, running <code class="docutils literal notranslate"><span class="pre">mdap</span> <span class="pre">-h</span></code> or <code class="docutils literal notranslate"><span class="pre">mdap</span> <span class="pre">--help</span></code> on the command line is very useful for a summary of the command options, along with some basic usage examples. To use the GUI, simply run <code class="docutils literal notranslate"><span class="pre">mdap</span></code> in the command line with no arguments.</p>
<p>The input data from standard MD simulations must be in &gt;=2 column format: use hash symbols (#) at top of data file to indicate comments (skipped lines)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>COL1:Frame | COL2:Data | COL3:Data...
</pre></div>
</div>
<p>This data can be output from anywhere, but just as long as it’s formatted as a text, numpy binary (<code class="docutils literal notranslate"><span class="pre">.npy</span></code>), or pickle (<code class="docutils literal notranslate"><span class="pre">.pkl</span></code>) file, it can be read into <code class="docutils literal notranslate"><span class="pre">mdap</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mdap</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># optionally apply default wedap matplotlib style sheet</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Example-1:-1D-Timeseries">
<h3>Example 1: 1D Timeseries<a class="headerlink" href="#Example-1:-1D-Timeseries" title="Permalink to this heading"></a></h3>
<p>The first plotting example shows a standard 1D timeseries plot for any input dataset, where the dataset or quantity of interest on the Y axis varies over time on the X axis. The <code class="docutils literal notranslate"><span class="pre">--timescale</span></code> flag is optional to convert the frame numbers to a specific timescale depending on the time interval that the data was saved.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ mdap -x rms_bb_xtal.dat --ylabel &quot;RMSD to XTAL ($\AA$)&quot; --plot-mode line --data-type time --timescale 10e4 --xlabel &quot;Time (µs)&quot;
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdap</span><span class="o">.</span><span class="n">MD_Plot</span><span class="p">(</span><span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">Xname</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rms_bb_xtal.dat&quot;</span><span class="p">],</span>
             <span class="n">timescale</span><span class="o">=</span><span class="mf">10e4</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Time (µs)&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;RMSD to XTAL ($\AA$)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_44_0.png" src="../_images/notebook_wedap_demo_44_0.png" />
</div>
</div>
</section>
<section id="id1">
<h3>Example 2: 1D Probability Distribution<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>We can make the same 1D line plot of the probability from any input data file. Note that if you have multiple replicates that you want to plot together, you can just include more data files after the X axis data input flag (<code class="docutils literal notranslate"><span class="pre">-X</span> <span class="pre">or</span> <span class="pre">--Xname</span> <span class="pre">file1.txt</span> <span class="pre">file2.txt</span> <span class="pre">...</span></code> and in Python you can input a list of file names into <code class="docutils literal notranslate"><span class="pre">mdap.MD_Pdist(Xname=[])</span></code>). Here, I am including just one file for the examples.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ mdap -x rms_bb_xtal.dat --xlabel &quot;RMSD to XTAL ($\AA$)&quot; -pm line
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdap</span><span class="o">.</span><span class="n">MD_Plot</span><span class="p">(</span><span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">Xname</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rms_bb_xtal.dat&quot;</span><span class="p">],</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;pdist&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;RMSD to XTAL ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_48_0.png" src="../_images/notebook_wedap_demo_48_0.png" />
</div>
</div>
</section>
<section id="id2">
<h3>Example 3: 2D Probability Distribution<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<p>Again, if we include another dataset for the Y axis, a 2D probability distribution can be plotted.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ mdap -x rms_bb_xtal.dat -y rms_bb_nmr.dat --xlabel &quot;RMSD to XTAL ($\AA$)&quot; --ylabel &quot;RMSD to NMR ($\AA$)&quot;
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdap</span><span class="o">.</span><span class="n">MD_Plot</span><span class="p">(</span><span class="n">Xname</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rms_bb_xtal.dat&quot;</span><span class="p">],</span> <span class="n">Yname</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rms_bb_nmr.dat&quot;</span><span class="p">],</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;pdist&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;RMSD to XTAL ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;RMSD to NMR ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_52_0.png" src="../_images/notebook_wedap_demo_52_0.png" />
</div>
</div>
</section>
<section id="id3">
<h3>Example 4: 3D Scatter Plot<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<p>Next, a scatter plot using 3 input datasets and notice how we can use a numpy binary file as input (<code class="docutils literal notranslate"><span class="pre">.npy</span></code>):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ mdap -x rms_bb_xtal.dat -y rms_bb_nmr.dat --xlabel &quot;RMSD to XTAL ($\AA$)&quot; --ylabel &quot;RMSD to NMR ($\AA$)&quot; -z c_angle.npy --cbar-label &quot;Helix Angle ($\degree$)&quot; -pm scatter3d
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdap</span><span class="o">.</span><span class="n">MD_Plot</span><span class="p">(</span><span class="n">Xname</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rms_bb_xtal.dat&quot;</span><span class="p">],</span> <span class="n">Yname</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rms_bb_nmr.dat&quot;</span><span class="p">],</span> <span class="n">Zname</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;c_angle.npy&quot;</span><span class="p">],</span>
             <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;pdist&quot;</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Helix Angle ($\degree$)&quot;</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;scatter3d&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;RMSD to XTAL ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;RMSD to NMR ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_56_0.png" src="../_images/notebook_wedap_demo_56_0.png" />
</div>
</div>
</section>
<section id="Example-5:-Joint-Plot-with-Extra-Features">
<h3>Example 5: Joint Plot with Extra Features<a class="headerlink" href="#Example-5:-Joint-Plot-with-Extra-Features" title="Permalink to this heading"></a></h3>
<p>For the last example in the <code class="docutils literal notranslate"><span class="pre">mdap</span></code> set, we can again demonsrate a variety of extra features, many of which are the same as with <code class="docutils literal notranslate"><span class="pre">wedap</span></code>. Something that is unique with <code class="docutils literal notranslate"><span class="pre">mdap</span></code> is that you can set <code class="docutils literal notranslate"><span class="pre">--Xinterval</span></code> || <code class="docutils literal notranslate"><span class="pre">MD_Plot.Xinterval</span></code> to apply to X Y or Z data (changing X to Y or Z in the arguments). This can adjust the size of your datasets if there is a mismatch (e.g. if you saved one dataset every 10 frames and the other every single frame). We can also see here that the
<code class="docutils literal notranslate"><span class="pre">--contour-interval</span></code> or <code class="docutils literal notranslate"><span class="pre">-ci</span></code> argument was used, which sets the interval of each contour level. The Y axis data is also being indexed to position 2, so if the input dataset has multiple columns they can all be accessed like this. Finally we set the <code class="docutils literal notranslate"><span class="pre">--style</span></code> argument to <code class="docutils literal notranslate"><span class="pre">None</span></code>, which sets everything back to the matplotlib plotting defaults.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ mdap -x rms_bb_xtal.dat -y o_angle12.dat --xlabel &quot;RMSD to XTAL ($\AA$)&quot; --ylabel &quot;Dimer Angle 2 ($\degree$)&quot; --Yindex 2 --Xinterval 10 -pm contour --color k --style None --p-units kT --contour-interval 0.5 --smoothing-level 2 --cmap gnuplot_r -jp --xlim 2 8 --ylim 20 60 --pmin 0.5
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># change to mpl default plotting settings</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">mdap</span><span class="o">.</span><span class="n">MD_Plot</span><span class="p">(</span><span class="n">Xname</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rms_bb_xtal.dat&quot;</span><span class="p">],</span> <span class="n">Yname</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;o_angle12.dat&quot;</span><span class="p">],</span> <span class="n">Yindex</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">p_min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                    <span class="n">contour_interval</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">smoothing_level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gnuplot_r&quot;</span><span class="p">,</span> <span class="n">jointplot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;pdist&quot;</span><span class="p">,</span> <span class="n">Xinterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;contour&quot;</span><span class="p">,</span> <span class="n">p_units</span><span class="o">=</span><span class="s2">&quot;kT&quot;</span><span class="p">,</span>
                    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;RMSD to XTAL ($\AA$)&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Dimer Angle 2 ($\degree$)&quot;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
<span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># save the resulting figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;mdap_jp.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/darian/github/wedap/wedap/h5_plot.py:254: UserWarning: With &#39;contour&#39; plot_type, p_max should be set. Otherwise max Z is used.
  warn(&#34;With &#39;contour&#39; plot_type, p_max should be set. Otherwise max Z is used.&#34;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_61_1.png" src="../_images/notebook_wedap_demo_61_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># optionally apply default wedap matplotlib style sheet</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Advanced-wedap-examples">
<h2>Advanced wedap examples<a class="headerlink" href="#Advanced-wedap-examples" title="Permalink to this heading"></a></h2>
<hr class="docutils" />
<section id="Example-1:-Multi-panel-Probability-Distributions">
<h3>Example 1: Multi-panel Probability Distributions<a class="headerlink" href="#Example-1:-Multi-panel-Probability-Distributions" title="Permalink to this heading"></a></h3>
<p>Here, we can make a plot showcasing multiple aux datasets and how they relate to the progress coordinate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
    <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;instant&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                  <span class="n">Xname</span><span class="o">=</span><span class="s2">&quot;pcoord&quot;</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;dihedral_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">10</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dihedral </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">10</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Dihedral Angle (°)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_65_0.png" src="../_images/notebook_wedap_demo_65_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;multi-panel-aux.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Since dihedral 11 looks interesting, we can make another multi-panel plot to showcase the time evolution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
    <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">first_iter</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">last_iter</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">,</span>
                  <span class="n">Xname</span><span class="o">=</span><span class="s2">&quot;pcoord&quot;</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;dihedral_11&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">6</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Dihedral Angle 11 (°)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "300ea64665964c8f93c5a4c7ff3923e5", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c6816f5308ac4a8b95c1f2c0d8c278cc", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8c3ac8dba81d4537b45604618349c683", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_68_3.png" src="../_images/notebook_wedap_demo_68_3.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;multi-panel-iters.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Example-2:-Multiple-Datasets-on-One-Plot">
<h3>Example 2: Multiple Datasets on One Plot<a class="headerlink" href="#Example-2:-Multiple-Datasets-on-One-Plot" title="Permalink to this heading"></a></h3>
<p>We can also directly compare multiple aux or pcoord datasets on a single axis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
    <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span>
                  <span class="n">Xname</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;dihedral_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Dihedral </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Dihedral Angle (°)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b52a533dd56048d5a25e751417267cac", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "462236c08ee247338d7e32a4d8f008af", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1489c8cf2eb346c28caf00d74a4e73f4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "555afa32adac4fb2b19fb1588a8eeffb", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7ff912b55d0f45158a158548ad6e3b3f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_72_5.png" src="../_images/notebook_wedap_demo_72_5.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;multi-aux-1d.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>If we wanted to, mdap could then be used to compare standard MD data to WE data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mdap</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
    <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span>
                  <span class="n">Xname</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;dihedral_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Dihedral </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># extra line needed to also plot the standard MD distribution data</span>
<span class="n">mdap</span><span class="o">.</span><span class="n">MD_Plot</span><span class="p">(</span><span class="n">Xname</span><span class="o">=</span><span class="s2">&quot;c_angle.dat&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;pdist&quot;</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span>
             <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;From MD&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Dihedral Angle (°)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f3cc0e55bf344890b8494356872ccfb7", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "82a988fdf87b4c73bc3faa0a44f63581", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "afff38a064d0407d8b38b0d5d01da5bf", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6577bab81646486d93f3ce2c996678dd", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4ef79d83e0b549ae8f9723cb4f40ddf5", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_75_5.png" src="../_images/notebook_wedap_demo_75_5.png" />
</div>
</div>
<p>But keep in mind that this example doesn’t make too much sense because the datasets between standard MD and WE are for different systems and metrics. Ideally, you could use this framework to compare the same calculation for the same system to see how (hopefully) the WE simulation was able to explore the landscape better than standard MD.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;multi-aux-1d-w-md.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Example-3:-Tracing-Trajectories">
<h3>Example 3: Tracing Trajectories<a class="headerlink" href="#Example-3:-Tracing-Trajectories" title="Permalink to this heading"></a></h3>
<p>We often want to see how a single continuous trajectory evolves as the WE simulation progresses.</p>
<p>If we want to trace the path to get to iteration 18 and segment 1:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W p53.h5 --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot; -dt average  \
        -y dihedral_11 --ylabel &quot;Dihedral 11 ($\degree$)&quot; --trace-seg 18 1
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap_obj</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">Xindex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;dihedral_11&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">((</span><span class="mi">18</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Dihedral 11 ($\degree$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d0b2374e66bc4c799510ee4d8f42bf6c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_81_1.png" src="../_images/notebook_wedap_demo_81_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;trace-seg.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Or we can trace by values, let’s say we want to find a walker that goes to a pcoord value of 5.8 and an aux value of 50:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W p53.h5 --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot; -dt average  \
        -y dihedral_11 --ylabel &quot;Dihedral 11 ($\degree$)&quot; --trace-val 5.8 50
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap_obj</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">Xindex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;dihedral_11&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="nb">iter</span><span class="p">,</span> <span class="n">seg</span> <span class="o">=</span> <span class="n">wedap_obj</span><span class="o">.</span><span class="n">search_aux_xy_nn</span><span class="p">(</span><span class="mf">5.8</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">((</span><span class="nb">iter</span><span class="p">,</span> <span class="n">seg</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Dihedral 11 ($\degree$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "099f8058b4de4b38a6a3664909218b6f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Go to ITERATION: 19 and SEGMENT: 331
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_85_2.png" src="../_images/notebook_wedap_demo_85_2.png" />
</div>
</div>
<p>We also get an output line of which iteration and segment the trace corresponds to.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;trace-val.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Example-4:-Making-a-GIF">
<h3>Example 4: Making a GIF<a class="headerlink" href="#Example-4:-Making-a-GIF" title="Permalink to this heading"></a></h3>
<p>Let’s now make a GIF of our data, here I am using the dihedral 11 aux dataset and looping through the averages of small sets of iteration ranges, but anything could be looped to make the GIF using this example as a template.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -h5 p53.h5 -y dihedral_11 -dt average --pmax 12 -pu kcal -li 19 --avg-plus 2 --gif-out example.gif --xlim 0 6 --ylim -180 180 --grid --cmap gnuplot_r --ylabel &quot;Dihedral Angle 11 (°)&quot; --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot;
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;h5&quot;</span> <span class="p">:</span> <span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Xname&quot;</span> <span class="p">:</span> <span class="s2">&quot;pcoord&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Yname&quot;</span> <span class="p">:</span> <span class="s2">&quot;dihedral_11&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                <span class="s2">&quot;p_max&quot;</span> <span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
                <span class="s2">&quot;p_units&quot;</span> <span class="p">:</span> <span class="s2">&quot;kcal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;first_iter&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;last_iter&quot;</span> <span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
                <span class="s2">&quot;plot_mode&quot;</span> <span class="p">:</span> <span class="s2">&quot;hist&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ylabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Dihedral Angle 11 (°)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;xlabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;xlim&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                <span class="s2">&quot;ylim&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span>
                <span class="s2">&quot;grid&quot;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;cmap&quot;</span> <span class="p">:</span> <span class="s2">&quot;gnuplot_r&quot;</span><span class="p">,</span>
                <span class="p">}</span>
<span class="n">wedap</span><span class="o">.</span><span class="n">make_gif</span><span class="p">(</span><span class="o">**</span><span class="n">plot_options</span><span class="p">,</span> <span class="n">avg_plus</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">gif_out</span><span class="o">=</span><span class="s2">&quot;example.gif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6ee2df33dc074b01a0ba2c883d09c7d4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>The resulting GIF is shown below:</p>
<p align="left"><p><img alt="example gif" class="no-scaled-link" src="../_images/example.gif" style="width: 400px;" /></p>
</p><hr class="docutils" />
<p>Here is an accessible version of the backend code for doing this, I provide it here since you can easily customize it with finer control to make more advanced gifs.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gif</span>
<span class="c1"># for a progress bar</span>
<span class="kn">from</span> <span class="nn">tqdm.auto</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="c1"># plots should not be saved with any transparency</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;savefig.transparent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;savefig.facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span>

<span class="c1"># decorate a plot function with @gif.frame (return not required):</span>
<span class="nd">@gif</span><span class="o">.</span><span class="n">frame</span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">avg_plus</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a gif of multiple wedap plots.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    iteration : int</span>
<span class="sd">        Plot a specific iteration.</span>
<span class="sd">    avg_plus : int</span>
<span class="sd">        With an average plot, this is the value added to iteration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plot_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;h5&quot;</span> <span class="p">:</span> <span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Xname&quot;</span> <span class="p">:</span> <span class="s2">&quot;pcoord&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Yname&quot;</span> <span class="p">:</span> <span class="s2">&quot;dihedral_11&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;data_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;p_max&quot;</span> <span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
                    <span class="s2">&quot;p_units&quot;</span> <span class="p">:</span> <span class="s2">&quot;kcal&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;first_iter&quot;</span> <span class="p">:</span> <span class="n">iteration</span><span class="p">,</span>
                    <span class="s2">&quot;last_iter&quot;</span> <span class="p">:</span> <span class="n">iteration</span> <span class="o">+</span> <span class="n">avg_plus</span><span class="p">,</span>
                    <span class="s2">&quot;plot_mode&quot;</span> <span class="p">:</span> <span class="s2">&quot;hist&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ylabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Dihedral Angle 11 (°)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;xlabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span> <span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;WE Iteration </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">iteration</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">avg_plus</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;xlim&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                    <span class="s2">&quot;ylim&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span>
                    <span class="s2">&quot;grid&quot;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;cmap&quot;</span> <span class="p">:</span> <span class="s2">&quot;gnuplot_r&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;no_pbar&quot;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="p">}</span>

    <span class="n">we</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="o">**</span><span class="n">plot_options</span><span class="p">)</span>
    <span class="n">we</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># build a bunch of &quot;frames&quot;</span>
<span class="c1"># having at least 100 frames makes for a good length gif</span>
<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># set the range to be the iterations at a specified interval</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">)):</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">avg_plus</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

<span class="c1"># specify the duration between frames (milliseconds) and save to file:</span>
<span class="n">gif</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="s2">&quot;example.gif&quot;</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0adaaf35f28c4c919ff4e57a4142fd10", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="Example-5:-Data-Extraction-for-Machine-Learning-with-scikit-learn">
<h3>Example 5: Data Extraction for Machine Learning with scikit-learn<a class="headerlink" href="#Example-5:-Data-Extraction-for-Machine-Learning-with-scikit-learn" title="Permalink to this heading"></a></h3>
<p>In this final example, I will go through how to extract data from a <code class="docutils literal notranslate"><span class="pre">west.h5</span></code> file using <code class="docutils literal notranslate"><span class="pre">wedap</span></code> and then we can directly pass the data to other Python libraries such as <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> to do some clustering and pca.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load h5 file into pdist class</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Pdist</span><span class="p">(</span><span class="s2">&quot;p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">)</span>

<span class="c1"># extract weights</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_all_weights</span><span class="p">()</span>

<span class="c1"># extract data arrays (can be pcoord or any aux data name)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_total_data_array</span><span class="p">(</span><span class="s2">&quot;pcoord&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_total_data_array</span><span class="p">(</span><span class="s2">&quot;pcoord&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># put X and Y together column wise</span>
<span class="n">XY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">))</span>

<span class="c1"># scale data</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">XY</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">XY</span><span class="p">)</span>

<span class="c1"># use 10x less data for easier plotting</span>
<span class="n">XY</span> <span class="o">=</span> <span class="n">XY</span><span class="p">[::</span><span class="mi">10</span><span class="p">,:]</span>

<span class="c1"># -ln(W/W(max)) weights</span>
<span class="n">weights_expanded</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">weights</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">weights</span><span class="p">))[::</span><span class="mi">10</span><span class="p">]</span>

<span class="c1"># cluster pdist using weighted k-means</span>
<span class="n">clust</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XY</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">weights_expanded</span><span class="p">)</span>

<span class="c1"># create plot base</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># get color labels</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;#377eb8&quot;</span><span class="p">,</span> <span class="s2">&quot;#ff7f00&quot;</span><span class="p">,</span> <span class="s2">&quot;#4daf4a&quot;</span><span class="p">,</span> <span class="s2">&quot;#f781bf&quot;</span><span class="p">,</span> <span class="s2">&quot;#a65628&quot;</span><span class="p">])</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmap</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">clust</span><span class="o">.</span><span class="n">labels_</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)]</span>

<span class="c1"># plot on PCs</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">PCs</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">XY</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">PCs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">PCs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e4b08b406d9e40a4a97d9879d8d64579", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "57e0c8e8a9c2434cad427fb2a0ad1afe", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_wedap_demo_99_2.png" src="../_images/notebook_wedap_demo_99_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;km_pca.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we have a plot along the first two principal components with cluster labels as the colors. Note that this isn’t necessarily the most rigorous example, but more of a demonstration of how to use <code class="docutils literal notranslate"><span class="pre">wedap</span></code> with a library like <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../wekap.html" class="btn btn-neutral float-left" title="wekap.kinetics module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Darian Yang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>