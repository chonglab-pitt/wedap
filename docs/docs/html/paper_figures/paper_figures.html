<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WEDAP Figures &mdash; WEDAP  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="WEDAP Demo" href="../notebook/wedap_demo.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            WEDAP
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wedap_modules.html">wedap modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdap_modules.html">mdap modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wekap_modules.html">wekap modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/wedap_demo.html">WEDAP Demo</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">WEDAP Figures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Example-1:-Evolution-Plot">Example 1: Evolution Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example-2:-1D-Probability-Distribution">Example 2: 1D Probability Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example-3:-2D-Probability-Distribution">Example 3: 2D Probability Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example-4:-3D-Scatter-Plot">Example 4: 3D Scatter Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example-5:-3D-Hexbin-Plot">Example 5: 3D Hexbin Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example-6:-2D-Hist-with-contour-lines">Example 6: 2D Hist with contour lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example-7:-3D-Contour-Plot">Example 7: 3D Contour Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example-8:-Joint-Plot">Example 8: Joint Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example-9:-4D-Scatter-Plot">Example 9: 4D Scatter Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example-10:-Tracing-Trajectories">Example 10: Tracing Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example-11:-Data-Extraction-for-Machine-Learning">Example 11: Data Extraction for Machine Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example-12:-Plotting-flux-evolutions">Example 12: Plotting flux evolutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example-13:-Making-a-GIF">Example 13: Making a GIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Other-WEDAP-features-not-demonstrated:">Other WEDAP features not demonstrated:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#TOC-Figure">TOC Figure</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WEDAP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">WEDAP Figures</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/paper_figures/paper_figures.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="WEDAP-Figures">
<h1>WEDAP Figures<a class="headerlink" href="#WEDAP-Figures" title="Permalink to this heading"></a></h1>
<hr class="docutils" />
<p><strong>WEDAP</strong> : <strong>W</strong>eighted <strong>E</strong>nsemble <strong>D</strong>ata <strong>A</strong>nalysis and <strong>P</strong>lotting (pronounced we-dap)</p>
<p><p><img alt="wedap logo" class="no-scaled-link" src="../_images/wedap_logo2.png" style="width: 200px;" /></p>
</p><p>This notebook is a more bare-bones (less explanations) example of how the figures for the <code class="docutils literal notranslate"><span class="pre">WEDAP</span></code> paper were created. More details about the plots can be found in the actual paper.</p>
<p>For general examples and explanations, see the <a class="reference external" href="https://github.com/darianyang/wedap/blob/main/docs/notebook/wedap_demo.ipynb">wedap demo jupyter notebook</a>. Note there is some similarity with the examples in the demo notebook and some of the examples in this notebook.</p>
<p>The format of the notebook will be to demonstrate creating each plot separately using the CLI (if available) and the Python API. All examples assume you’re running them in the <code class="docutils literal notranslate"><span class="pre">paper_figures/</span></code> directory.</p>
<p>CLI commands are denoted in markdown as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap --help
</pre></div>
</div>
<p>Python API scripting is done directly within the cells of the Jupyter notebook.</p>
<p><strong>The main ``WEDAP`` plotting arguments:</strong></p>
<p>Available <code class="docutils literal notranslate"><span class="pre">--data-type</span></code> || <code class="docutils literal notranslate"><span class="pre">data_type</span></code> options: * <code class="docutils literal notranslate"><span class="pre">evolution</span></code> – plot the evolution of a 1D pcoord over each WE iteration. * <code class="docutils literal notranslate"><span class="pre">average</span></code> – plot 1D or 2D+ using a range of WE iterations. * <code class="docutils literal notranslate"><span class="pre">instant</span></code> – plot 1D or 2D+ using a single WE iteration.</p>
<p>Available <code class="docutils literal notranslate"><span class="pre">--plot-mode</span></code> || <code class="docutils literal notranslate"><span class="pre">plot_mode</span></code> options: * <code class="docutils literal notranslate"><span class="pre">line</span></code> – plot 1D lines. * <code class="docutils literal notranslate"><span class="pre">hist</span></code> – plot histogram (default). * <code class="docutils literal notranslate"><span class="pre">hist_l</span></code> – plot histogram and contour lines. * <code class="docutils literal notranslate"><span class="pre">contour</span></code> – plot contour levels and lines. * <code class="docutils literal notranslate"><span class="pre">contour_f</span></code> – plot contour levels only. * <code class="docutils literal notranslate"><span class="pre">contour_l</span></code> – plot contour lines only. * <code class="docutils literal notranslate"><span class="pre">scatter3d</span></code> – plot 3 datasets in a scatter plot. * <code class="docutils literal notranslate"><span class="pre">hexbin3d</span></code> – plot 3 datasets in a hexbin plot.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">wedap</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># optionally apply default wedap matplotlib style sheet</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Example-1:-Evolution-Plot">
<h2>Example 1: Evolution Plot<a class="headerlink" href="#Example-1:-Evolution-Plot" title="Permalink to this heading"></a></h2>
<p>This is a classic plot of the evolution of a WE simulation, plotting the probability distribution on the X axis as you progress through each iteration of the WE simulation on the Y axis. The colorbar is showing the probability values of each bin in the histogram. The probability values are derived from the raw data count values of the multiple segments in each WE iteration in the west.h5 file, weighted by each segment weight. This weighted histogram is normalized and shown on an inverted natural
log scale: <span class="math notranslate nohighlight">\(-\ln(\frac{P(x)}{P(max)})\)</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W west.h5 --data-type evolution --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot;
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;evolution&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;WE Iteration&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7c262469775242f5aedfde46cf914877", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(4.875000000000002, 0.5, &#39;WE Iteration&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_7_2.png" src="../_images/paper_figures_paper_figures_7_2.png" />
</div>
</div>
</section>
<section id="Example-2:-1D-Probability-Distribution">
<h2>Example 2: 1D Probability Distribution<a class="headerlink" href="#Example-2:-1D-Probability-Distribution" title="Permalink to this heading"></a></h2>
<p>You can also make simple 1D plots for a single iteration <code class="docutils literal notranslate"><span class="pre">--data-type</span> <span class="pre">instant</span></code> || <code class="docutils literal notranslate"><span class="pre">data_type='instant'</span></code> or for the average of a range of iterations <code class="docutils literal notranslate"><span class="pre">--data-type</span> <span class="pre">average</span></code> || <code class="docutils literal notranslate"><span class="pre">data_type='average'</span></code>. Here we show the average probability distribution for the entire range of WE iterations in the input <code class="docutils literal notranslate"><span class="pre">west.h5</span></code> file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W west.h5 -dt average --plot-mode line --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot;
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "fe8b3678468d4c169ae27ce74c3eb975", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, -6.000000000000005, &#39;Heavy Atom RMSD ($\\AA$)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_11_2.png" src="../_images/paper_figures_paper_figures_11_2.png" />
</div>
</div>
<p>We can make advanced plots using this 1D framework:</p>
<p>Here we plot multiple datasets on one plot and also include the data from standard MD.</p>
<p>We can also directly compare multiple aux or pcoord datasets on a single axis.</p>
<p>If we wanted to, mdap could then be used to compare standard MD data to WE data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># change style back to wedap default</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mdap</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;RMS_Backbone&quot;</span><span class="p">,</span> <span class="s2">&quot;RMS_Heavy&quot;</span><span class="p">],[</span><span class="s2">&quot;Backbone RMSD&quot;</span><span class="p">,</span> <span class="s2">&quot;Heavy Atom RMSD&quot;</span><span class="p">]):</span>
    <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span>
                  <span class="n">Xname</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># extra line needed to also plot the standard MD distribution data</span>
<span class="n">mdap</span><span class="o">.</span><span class="n">MD_Plot</span><span class="p">(</span><span class="n">Xname</span><span class="o">=</span><span class="s2">&quot;rms_heavy_nmr.dat&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;pdist&quot;</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span>
             <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;From MD&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9cb0624558de40c9b26ebe08b6b374f8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1154540a11774090badfc59a11f4b019", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_16_2.png" src="../_images/paper_figures_paper_figures_16_2.png" />
</div>
</div>
<p>But keep in mind that this example doesn’t make too much sense because the datasets between standard MD and WE are for different systems and metrics. Ideally, you could use this framework to compare the same calculation for the same system to see how (hopefully) the WE simulation was able to explore the landscape better than standard MD.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;e2.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Example-3:-2D-Probability-Distribution">
<h2>Example 3: 2D Probability Distribution<a class="headerlink" href="#Example-3:-2D-Probability-Distribution" title="Permalink to this heading"></a></h2>
<p>We can also make probability distributions using two datasets, first we can try this with just our two dimensional progress coordinates. Note that you can set the progress coordinate or any aux dataset index using <code class="docutils literal notranslate"><span class="pre">Xindex</span></code>, <code class="docutils literal notranslate"><span class="pre">Yindex</span></code>, and <code class="docutils literal notranslate"><span class="pre">Zindex</span></code>. This can be useful for multi-dimensional progress coordinates, but also for multi-dimensional auxiliary data.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W west.h5 --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot; -dt average -y RoG --ylabel &quot;Radius of Gyration ($\AA$)&quot;
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">Xindex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;RoG&quot;</span><span class="p">,</span> <span class="n">Yindex</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f7723d00277045f7b70f5994ad7dc0c5", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.3750000000000018, 0.5, &#39;Radius of Gyration ($\\AA$)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_22_2.png" src="../_images/paper_figures_paper_figures_22_2.png" />
</div>
</div>
</section>
<section id="Example-4:-3D-Scatter-Plot">
<h2>Example 4: 3D Scatter Plot<a class="headerlink" href="#Example-4:-3D-Scatter-Plot" title="Permalink to this heading"></a></h2>
<p>What if you don’t want to show the probability axis? Well, you can also just show how three different datasets are related in a 3D scatter plot. Here we can put two different aux datasets on the X and Y axes and we can set the colorbar to show the progress coordinate values in comparison:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W west.h5 --xlabel &quot;Radius of Gyration ($\AA$)&quot; -x RoG  -dt average  -y Total_SASA --ylabel &quot;SASA ($\AA^2$)&quot; -z pcoord --cbar-label &quot;Heavy Atom RMSD ($\AA$)&quot; -pm scatter3d --scatter-interval 10 --scatter-size 1
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;scatter3d&quot;</span><span class="p">,</span>
              <span class="n">Xname</span><span class="o">=</span><span class="s2">&quot;RoG&quot;</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;Total_SASA&quot;</span><span class="p">,</span> <span class="n">Zname</span><span class="o">=</span><span class="s2">&quot;pcoord&quot;</span><span class="p">,</span>
              <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span> <span class="n">scatter_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scatter_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
              <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;SASA ($\AA^2$)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4c55a23d777846519fc6e908d172d927", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_26_1.png" src="../_images/paper_figures_paper_figures_26_1.png" />
</div>
</div>
</section>
<section id="Example-5:-3D-Hexbin-Plot">
<h2>Example 5: 3D Hexbin Plot<a class="headerlink" href="#Example-5:-3D-Hexbin-Plot" title="Permalink to this heading"></a></h2>
<p>We can make a similar 3D plot using hexbins.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W west.h5 --xlabel &quot;Radius of Gyration ($\AA$)&quot; -x RoG  -dt average  -y Total_SASA --ylabel &quot;SASA ($\AA^2$)&quot; -z pcoord --cbar-label &quot;Heavy Atom RMSD ($\AA$)&quot; -pm hexbin3d --hexbin-grid 25
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;hexbin3d&quot;</span><span class="p">,</span>
              <span class="n">Xname</span><span class="o">=</span><span class="s2">&quot;RoG&quot;</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;Total_SASA&quot;</span><span class="p">,</span> <span class="n">Zname</span><span class="o">=</span><span class="s2">&quot;pcoord&quot;</span><span class="p">,</span>
              <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span> <span class="n">hexbin_grid</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
              <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;SASA ($\AA^2$)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "abe0b6f4ee074ee696a4aa3075f21fe6", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_30_1.png" src="../_images/paper_figures_paper_figures_30_1.png" />
</div>
</div>
</section>
<section id="Example-6:-2D-Hist-with-contour-lines">
<h2>Example 6: 2D Hist with contour lines<a class="headerlink" href="#Example-6:-2D-Hist-with-contour-lines" title="Permalink to this heading"></a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -h5 west.h5 -dt average -pm hist_l -X pcoord -Y RoG --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot; --ylabel &quot;Radius of Gyration ($\AA$)&quot; --contour-interval 1 --pmax 20 -pu kcal --cmap afmhot_r --color k -lw 0.4 -sl 1 -hrx 2 6.5 -hry 17 20.5
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if there is alot of plotting choices, it can be easier to just put it all into a dictionary</span>
<span class="n">plot_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;h5&quot;</span> <span class="p">:</span> <span class="s2">&quot;west.h5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                <span class="s2">&quot;plot_mode&quot;</span> <span class="p">:</span> <span class="s2">&quot;hist_l&quot;</span><span class="p">,</span>
                <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Xname&quot;</span> <span class="p">:</span> <span class="s2">&quot;pcoord&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Yname&quot;</span> <span class="p">:</span> <span class="s2">&quot;RoG&quot;</span><span class="p">,</span>
                <span class="s2">&quot;p_units&quot;</span> <span class="p">:</span> <span class="s2">&quot;kcal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cmap&quot;</span> <span class="p">:</span> <span class="s2">&quot;afmhot_r&quot;</span><span class="p">,</span>
                <span class="s2">&quot;xlabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ylabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;p_max&quot;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                <span class="s2">&quot;contour_interval&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;linewidth&quot;</span> <span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
                <span class="s2">&quot;smoothing_level&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;histrange_x&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                <span class="s2">&quot;histrange_y&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mf">20.5</span><span class="p">),</span>
                <span class="p">}</span>
<span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="o">**</span><span class="n">plot_options</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5ca24c71f98544d3a65b40616c64ee42", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_33_1.png" src="../_images/paper_figures_paper_figures_33_1.png" />
</div>
</div>
<p>We can also use the histogram from WE and grab the contour lines overlaid from standard MD:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mdap</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># if there is alot of plotting choices, it can be easier to just put it all into a dictionary</span>
<span class="n">plot_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;h5&quot;</span> <span class="p">:</span> <span class="s2">&quot;west.h5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                <span class="s2">&quot;plot_mode&quot;</span> <span class="p">:</span> <span class="s2">&quot;hist&quot;</span><span class="p">,</span>
                <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Xname&quot;</span> <span class="p">:</span> <span class="s2">&quot;RMS_Heavy&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Yname&quot;</span> <span class="p">:</span> <span class="s2">&quot;RoG&quot;</span><span class="p">,</span>
                <span class="s2">&quot;p_units&quot;</span> <span class="p">:</span> <span class="s2">&quot;kcal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cmap&quot;</span> <span class="p">:</span> <span class="s2">&quot;afmhot_r&quot;</span><span class="p">,</span>
                <span class="s2">&quot;xlabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ylabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;p_max&quot;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                <span class="s2">&quot;contour_interval&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;linewidth&quot;</span> <span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
                <span class="s2">&quot;smoothing_level&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;histrange_x&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                <span class="s2">&quot;histrange_y&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mf">20.5</span><span class="p">),</span>
                <span class="s2">&quot;ax&quot;</span> <span class="p">:</span> <span class="n">ax</span><span class="p">,</span>
                <span class="p">}</span>
<span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="o">**</span><span class="n">plot_options</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">mdap</span><span class="o">.</span><span class="n">MD_Plot</span><span class="p">(</span><span class="n">Xname</span><span class="o">=</span><span class="s2">&quot;rms_heavy_nmr.dat&quot;</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;RoG.dat&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;contour_l&quot;</span><span class="p">,</span> <span class="c1">#p_max=3, p_units=&quot;kT&quot;,</span>
             <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;pdist&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">smoothing_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">contour_interval</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9ab3a12014264375b24fce559677c595", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_35_1.png" src="../_images/paper_figures_paper_figures_35_1.png" />
</div>
</div>
</section>
<section id="Example-7:-3D-Contour-Plot">
<h2>Example 7: 3D Contour Plot<a class="headerlink" href="#Example-7:-3D-Contour-Plot" title="Permalink to this heading"></a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -h5 west.h5 -dt average -pm contour -X pcoord -Y RoG --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot; --ylabel &quot;Radius of Gyration ($\AA$)&quot; --contour-interval 0.2 --zlabel &quot;-RT ln(P) (kcal/mol)&quot; --p-units kcal -3d --style None
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if there is alot of plotting choices, it can be easier to just put it all into a dictionary</span>
<span class="n">plot_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;h5&quot;</span> <span class="p">:</span> <span class="s2">&quot;west.h5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                <span class="s2">&quot;plot_mode&quot;</span> <span class="p">:</span> <span class="s2">&quot;contour&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Xname&quot;</span> <span class="p">:</span> <span class="s2">&quot;pcoord&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Yname&quot;</span> <span class="p">:</span> <span class="s2">&quot;RoG&quot;</span><span class="p">,</span>
                <span class="s2">&quot;zlabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;-RT ln(P) (kcal/mol)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;p_units&quot;</span> <span class="p">:</span> <span class="s2">&quot;kcal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;xlabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ylabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;contour_interval&quot;</span> <span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
                <span class="s2">&quot;proj3d&quot;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="p">}</span>
<span class="c1"># default None mpl style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="o">**</span><span class="n">plot_options</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a7fa99e87eab4d1b92f64b4e2660cee0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/darian/github/wedap/wedap/h5_plot.py:267: UserWarning: With &#39;contour&#39; plot_type, p_max should be set. Otherwise max Z is used.
  warn(&#34;With &#39;contour&#39; plot_type, p_max should be set. Otherwise max Z is used.&#34;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_38_2.png" src="../_images/paper_figures_paper_figures_38_2.png" />
</div>
</div>
</section>
<section id="Example-8:-Joint-Plot">
<h2>Example 8: Joint Plot<a class="headerlink" href="#Example-8:-Joint-Plot" title="Permalink to this heading"></a></h2>
<p>Here, I want to demonstrate some of the additional features available by making a more complicated joint plot. This is using a contour plot instead of a histogram, as set by <code class="docutils literal notranslate"><span class="pre">--plot-mode</span> <span class="pre">contour</span></code> || <code class="docutils literal notranslate"><span class="pre">plot_mode='contour'</span></code>, there is also custom colormapping (<code class="docutils literal notranslate"><span class="pre">--cmap</span></code>), probability units (<code class="docutils literal notranslate"><span class="pre">--p-units</span></code>), iteration ranges (<code class="docutils literal notranslate"><span class="pre">--first-iter</span></code>, <code class="docutils literal notranslate"><span class="pre">--last-iter</span></code>), probability limits (<code class="docutils literal notranslate"><span class="pre">--pmin</span></code>, <code class="docutils literal notranslate"><span class="pre">--pmax</span></code>), plot style (<code class="docutils literal notranslate"><span class="pre">--style</span></code>), data smoothing (<code class="docutils literal notranslate"><span class="pre">--smoothing-level</span></code>), and plot limits
(<code class="docutils literal notranslate"><span class="pre">--xlim</span></code>, <code class="docutils literal notranslate"><span class="pre">--ylim</span></code>).</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W west.h5 -dt average -pm contour_f -x pcoord -y RoG --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot; --ylabel &quot;Radius of Gyration ($\AA$)&quot; --joint-plot -pm contour_f --cmap gnuplot_r --style ggplot --p-units kcal --first-iter 3 --last-iter 200 --pmin 0.5 --pmax 17.5 --smoothing-level 1 --xlim 2 6.5 --ylim 17 20.5
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if there is alot of plotting choices, it can be easier to just put it all into a dictionary</span>
<span class="n">plot_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;h5&quot;</span> <span class="p">:</span> <span class="s2">&quot;west.h5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                <span class="s2">&quot;plot_mode&quot;</span> <span class="p">:</span> <span class="s2">&quot;contour_f&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Xname&quot;</span> <span class="p">:</span> <span class="s2">&quot;pcoord&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Yname&quot;</span> <span class="p">:</span> <span class="s2">&quot;RoG&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cmap&quot;</span> <span class="p">:</span> <span class="s2">&quot;gnuplot_r&quot;</span><span class="p">,</span>
                <span class="s2">&quot;jointplot&quot;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;p_units&quot;</span> <span class="p">:</span> <span class="s2">&quot;kcal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;first_iter&quot;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s2">&quot;last_iter&quot;</span> <span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s2">&quot;p_min&quot;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                <span class="s2">&quot;p_max&quot;</span> <span class="p">:</span> <span class="mf">17.5</span><span class="p">,</span>
                <span class="s2">&quot;smoothing_level&quot;</span> <span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                <span class="c1"># the input plot_options kwarg dict is also parsed for matplotlib formatting keywords</span>
                <span class="s2">&quot;xlabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ylabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;xlim&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                <span class="s2">&quot;ylim&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mf">20.5</span><span class="p">),</span>
                <span class="s2">&quot;style&quot;</span> <span class="p">:</span> <span class="s2">&quot;ggplot&quot;</span><span class="p">,</span>
                <span class="p">}</span>
<span class="c1"># set style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;ggplot&quot;</span><span class="p">)</span>
<span class="c1"># change size since joint plots take more space</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="o">**</span><span class="n">plot_options</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># save the resulting figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;e6.png&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b8aac847300c4e05a62aea7a5a448587", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_42_1.png" src="../_images/paper_figures_paper_figures_42_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># change style back to wedap default</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Example-9:-4D-Scatter-Plot">
<h2>Example 9: 4D Scatter Plot<a class="headerlink" href="#Example-9:-4D-Scatter-Plot" title="Permalink to this heading"></a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -h5 west.h5 -dt average -pm scatter3d -X Total_SASA -Y RoG -Z pcoord -C Num_Inter_NC --cmap gnuplot_r --p-units kcal --xlabel &quot;SASA ($\AA^2$)&quot; --ylabel &quot;Radius of Gyration ($\AA$)&quot; --zlabel &quot;Heavy Atom RMSD ($\AA$)&quot; --cbar-label &quot;Number of Native Contacts&quot; -4d --style None
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if there is alot of plotting choices, it can be easier to just put it all into a dictionary</span>
<span class="n">plot_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;h5&quot;</span> <span class="p">:</span> <span class="s2">&quot;west.h5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                <span class="s2">&quot;plot_mode&quot;</span> <span class="p">:</span> <span class="s2">&quot;scatter3d&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Xname&quot;</span> <span class="p">:</span> <span class="s2">&quot;Total_SASA&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Yname&quot;</span> <span class="p">:</span> <span class="s2">&quot;RoG&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Zname&quot;</span> <span class="p">:</span> <span class="s2">&quot;pcoord&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Cname&quot;</span> <span class="p">:</span> <span class="s2">&quot;Num_Inter_NC&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cmap&quot;</span> <span class="p">:</span> <span class="s2">&quot;gnuplot_r&quot;</span><span class="p">,</span>
                <span class="s2">&quot;p_units&quot;</span> <span class="p">:</span> <span class="s2">&quot;kcal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;xlabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;SASA ($\AA^2$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ylabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;zlabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cbar_label&quot;</span> <span class="p">:</span> <span class="s2">&quot;Number of Native Contacts&quot;</span><span class="p">,</span>
                <span class="s2">&quot;proj4d&quot;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="p">}</span>
<span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="o">**</span><span class="n">plot_options</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a665480cc6ec43d39fdc440eee101543", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_46_1.png" src="../_images/paper_figures_paper_figures_46_1.png" />
</div>
</div>
</section>
<section id="Example-10:-Tracing-Trajectories">
<h2>Example 10: Tracing Trajectories<a class="headerlink" href="#Example-10:-Tracing-Trajectories" title="Permalink to this heading"></a></h2>
<p>We often want to see how a single continuous trajectory evolves as the WE simulation progresses.</p>
<p>If we want to trace the path to get to iteration 200 and segment 1:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W west.h5 --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot; -dt average -y RoG --ylabel &quot;Radius of Gyration ($\AA$)&quot; --trace-seg 200 20
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap_obj</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">Xindex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;RoG&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f18809d6602449d0a51fea1b85d39cd8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_50_1.png" src="../_images/paper_figures_paper_figures_50_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;trace-seg.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Or we can trace by values, let’s say we want to find a walker that goes to a pcoord value of 5.5 and an aux value of 19.5:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W west.h5 --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot; -dt average -y RoG --ylabel &quot;Radius of Gyration ($\AA$)&quot; --trace-val 5.5 19.5
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap_obj</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">Xindex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;RoG&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">((</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">19.5</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="n">find_iter_seg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8f58478bc6984069a7dec105685c7108", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "441bb32b9fbd47839493ecb54272da46", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Tracing ITERATION: 195, SEGMENT: 46
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_54_3.png" src="../_images/paper_figures_paper_figures_54_3.png" />
</div>
</div>
<p>We also get an output line of which iteration and segment the trace corresponds to.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;trace-val.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next, a hexbin plot with multiple traces on top (inspired by Lorenzo Casalino).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap_obj</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;hexbin3d&quot;</span><span class="p">,</span>
                          <span class="n">Xname</span><span class="o">=</span><span class="s2">&quot;RMS_Backbone&quot;</span><span class="p">,</span> <span class="n">Yname</span><span class="o">=</span><span class="s2">&quot;RoG&quot;</span><span class="p">,</span> <span class="n">Zname</span><span class="o">=</span><span class="s2">&quot;Num_Inter_NC&quot;</span><span class="p">,</span>
                          <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Backbone RMSD ($\AA$)&quot;</span><span class="p">,</span> <span class="n">hexbin_grid</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                          <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Native Contacts&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">((</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">19.5</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gold&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">find_iter_seg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;snow&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "fd9c6fb2fe144883b2dd330768a1039c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e25fb44e9ddc41a183598cab106e4ad0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Tracing ITERATION: 200, SEGMENT: 58
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_58_3.png" src="../_images/paper_figures_paper_figures_58_3.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;e10.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Example-11:-Data-Extraction-for-Machine-Learning">
<h2>Example 11: Data Extraction for Machine Learning<a class="headerlink" href="#Example-11:-Data-Extraction-for-Machine-Learning" title="Permalink to this heading"></a></h2>
<p>In this example, I will go through how to extract data from a <code class="docutils literal notranslate"><span class="pre">west.h5</span></code> file using <code class="docutils literal notranslate"><span class="pre">wedap</span></code> and then we can directly pass the data to other Python libraries such as <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> to do some clustering and pca.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># load h5 file into pdist class</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Pdist</span><span class="p">(</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">)</span>

<span class="c1"># extract weights</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_all_weights</span><span class="p">()</span>

<span class="c1"># extract data arrays (can be pcoord or any aux data name)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_total_data_array</span><span class="p">(</span><span class="s2">&quot;pcoord&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_total_data_array</span><span class="p">(</span><span class="s2">&quot;RoG&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_total_data_array</span><span class="p">(</span><span class="s2">&quot;Total_SASA&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_total_data_array</span><span class="p">(</span><span class="s2">&quot;Num_Inter_NC&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># put data together column wise</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">A</span><span class="p">))</span>

<span class="c1"># scale data</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

<span class="c1"># do PCA</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">PCs</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

<span class="c1"># -ln(W/W(max)) weights</span>
<span class="n">weights_expanded</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">weights</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">weights</span><span class="p">))</span>

<span class="c1"># cluster pdist using weighted k-means</span>
<span class="n">clust</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">PCs</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">weights_expanded</span><span class="p">)</span>

<span class="c1"># create plot base</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">PCs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">PCs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">clust</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6303f0057ca94ff6a392b9edccdaa7ca", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d1267e091e154decad018aa6e7673cbe", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a019c2628012489e92e1af09fd4e206f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3b0b8fad6d33497a9c5320908a75350f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_62_4.png" src="../_images/paper_figures_paper_figures_62_4.png" />
</div>
</div>
<p>Now we have a plot along the first two principal components with cluster labels as the colors. Note that this isn’t necessarily the most rigorous example, but more of a demonstration of how to use <code class="docutils literal notranslate"><span class="pre">wedap</span></code> with a library like <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;e11.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can also input the arrays for PC1 and PC2 and plot the 2D pdist.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PCs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(87516, 2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(87516, 1)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap_obj</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">Xname</span><span class="o">=</span><span class="n">PCs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">Yname</span><span class="o">=</span><span class="n">PCs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;PC1&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9ff5cf90d3f441339b8fd35d0f379f33", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_68_1.png" src="../_images/paper_figures_paper_figures_68_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the resulting figure</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;e11-2.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can also make a 3D plot to look at what may relate to the PCs that were calculated:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clust</span><span class="o">.</span><span class="n">labels_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(87516, 1)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap_obj</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;hexbin3d&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">hexbin_grid</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                          <span class="n">Xname</span><span class="o">=</span><span class="n">PCs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">Yname</span><span class="o">=</span><span class="n">PCs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">Zname</span><span class="o">=</span><span class="s2">&quot;pcoord&quot;</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;PC1&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4241f725b1af40d8bd33c1796f845dd5", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_72_1.png" src="../_images/paper_figures_paper_figures_72_1.png" />
</div>
</div>
<p>What if we want to make a new h5 file with PCs as aux data? Well we can just include some extra args:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap_obj</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west.h5&quot;</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;hexbin3d&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">hexbin_grid</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                          <span class="n">H5save_out</span><span class="o">=</span><span class="s2">&quot;west-new.h5&quot;</span><span class="p">,</span> <span class="n">Xsave_name</span><span class="o">=</span><span class="s2">&quot;PC1&quot;</span><span class="p">,</span>
                          <span class="n">Xname</span><span class="o">=</span><span class="n">PCs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">Yname</span><span class="o">=</span><span class="n">PCs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">Zname</span><span class="o">=</span><span class="s2">&quot;pcoord&quot;</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;PC1&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a58ed6027897458a8a6b0b2daecc4007", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1e404175b7164ff29c60c12d12e08f6a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_74_2.png" src="../_images/paper_figures_paper_figures_74_2.png" />
</div>
</div>
<p>Now we can just plot using PC1 and any of the CLI/API plotting options.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -W west-new.h5 -pm line -dt average -X PC1 --xlabel PC1
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;west-new.h5&quot;</span><span class="p">,</span> <span class="n">plot_mode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">Xname</span><span class="o">=</span><span class="s2">&quot;PC1&quot;</span><span class="p">,</span> <span class="n">Xlabel</span><span class="o">=</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cf636e4e68ab44539f49fbb6238d2d06", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_77_1.png" src="../_images/paper_figures_paper_figures_77_1.png" />
</div>
</div>
</section>
<section id="Example-12:-Plotting-flux-evolutions">
<h2>Example 12: Plotting flux evolutions<a class="headerlink" href="#Example-12:-Plotting-flux-evolutions" title="Permalink to this heading"></a></h2>
<p>We can also plot the rate constant analysis dataset from WESTPA, which is output in a direct.h5 file.</p>
<p>First we can write a Python script to demonstrate the WEDAP post processing function, which allows for highly custom plot formatting and post processing using an additional Python script input. This example plots a horizontal line after the rate constant plot is generated.</p>
<p>The following script is named <code class="docutils literal notranslate"><span class="pre">ppf.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">adjust</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can then run <code class="docutils literal notranslate"><span class="pre">wedap</span></code>, <code class="docutils literal notranslate"><span class="pre">mdap</span></code>, or <code class="docutils literal notranslate"><span class="pre">wekap</span></code> with the <code class="docutils literal notranslate"><span class="pre">--postprocess</span></code> arg, calling a Python module:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wekap -d ANALYSIS/TEST/direct.h5 --postprocess ppf.adjust
</pre></div>
</div>
<p>Alternatively using the API:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">wekap</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wekap</span><span class="o">.</span><span class="n">Kinetics</span><span class="p">(</span><span class="n">direct</span><span class="o">=</span><span class="s2">&quot;ANALYSIS/TEST/direct.h5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot_rate</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_86_0.png" src="../_images/paper_figures_paper_figures_86_0.png" />
</div>
</div>
</section>
<section id="Example-13:-Making-a-GIF">
<h2>Example 13: Making a GIF<a class="headerlink" href="#Example-13:-Making-a-GIF" title="Permalink to this heading"></a></h2>
<p>Here we can observe the time evolution of a 2D pdist using a gif. The avg_plus arg is used to select the range of iterations to average (so for a value of 10, we average n+10 iterations per frame of the gif).</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ wedap -h5 west.h5 -x pcoord -y RoG -dt average --pmax 17.5 -pu kcal -li 190 --step-iter 2 --avg-plus 2 --gif-out example.gif --xlim 2 6.5 --ylim 17 20.5 --grid --cmap gnuplot_r --ylabel &quot;Radius of Gyration ($\AA$)&quot; --xlabel &quot;Heavy Atom RMSD ($\AA$)&quot;
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[93]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;h5&quot;</span> <span class="p">:</span> <span class="s2">&quot;west.h5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Xname&quot;</span> <span class="p">:</span> <span class="s2">&quot;pcoord&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Yname&quot;</span> <span class="p">:</span> <span class="s2">&quot;RoG&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                <span class="s2">&quot;p_max&quot;</span> <span class="p">:</span> <span class="mf">17.5</span><span class="p">,</span>
                <span class="s2">&quot;p_units&quot;</span> <span class="p">:</span> <span class="s2">&quot;kcal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;first_iter&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;last_iter&quot;</span> <span class="p">:</span> <span class="mi">190</span><span class="p">,</span>
                <span class="s2">&quot;step_iter&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;plot_mode&quot;</span> <span class="p">:</span> <span class="s2">&quot;hist&quot;</span><span class="p">,</span>
                <span class="s2">&quot;xlabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ylabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;xlim&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                <span class="s2">&quot;ylim&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mf">20.5</span><span class="p">),</span>
                <span class="s2">&quot;grid&quot;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;cmap&quot;</span> <span class="p">:</span> <span class="s2">&quot;gnuplot_r&quot;</span><span class="p">,</span>
                <span class="p">}</span>
<span class="n">wedap</span><span class="o">.</span><span class="n">make_gif</span><span class="p">(</span><span class="o">**</span><span class="n">plot_options</span><span class="p">,</span> <span class="n">avg_plus</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gif_out</span><span class="o">=</span><span class="s2">&quot;example.gif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2bb69ed486364add911d773e0a1b9d50", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>The resulting GIF is shown below:</p>
<p align="left"><p><img alt="example gif" class="no-scaled-link" src="../_images/example1.gif" style="width: 400px;" /></p>
</p></section>
<section id="Other-WEDAP-features-not-demonstrated:">
<h2>Other WEDAP features not demonstrated:<a class="headerlink" href="#Other-WEDAP-features-not-demonstrated:" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>multiple h5 inputs (just input a list or multiple h5 files in the command line)</p>
<ul>
<li><p>these are automatically normalized and plotted as long as the dataset specified exisits in all h5 files input</p></li>
</ul>
</li>
<li><p>Input for <code class="docutils literal notranslate"><span class="pre">X/Y/Z/Cname</span></code> can be a dataset in the west.h5 file (as seen here), but also an numpy array (seen in the ML example) or the name of a file (with a <code class="docutils literal notranslate"><span class="pre">.dat</span></code>, <code class="docutils literal notranslate"><span class="pre">.txt</span></code>, <code class="docutils literal notranslate"><span class="pre">.pkl</span></code>, <code class="docutils literal notranslate"><span class="pre">.npz</span></code>, <code class="docutils literal notranslate"><span class="pre">.npy</span></code> ending).</p></li>
<li><p>trajectory filtering for only successfull events (set <code class="docutils literal notranslate"><span class="pre">succ_only=True</span></code>)</p></li>
<li><p>basis state filtering for trajectories from a specific basis state(s) (<code class="docutils literal notranslate"><span class="pre">skip_basis</span></code>)</p></li>
<li><p>the commands and usage for <code class="docutils literal notranslate"><span class="pre">MDAP</span></code> were not demonstrated here, but examples can be found on the <a class="reference external" href="https://github.com/darianyang/wedap/blob/main/docs/notebook/wedap_demo.ipynb">wedap demo jupyter notebook</a>.</p>
<ul>
<li><p>besides the WE evolution plot, most other <code class="docutils literal notranslate"><span class="pre">WEDAP</span></code> plots can be made using standard MD data instead of a <code class="docutils literal notranslate"><span class="pre">west.h5</span></code> file from <code class="docutils literal notranslate"><span class="pre">WESTPA</span></code>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="TOC-Figure">
<h2>TOC Figure<a class="headerlink" href="#TOC-Figure" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[89]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if there is alot of plotting choices, it can be easier to just put it all into a dictionary</span>
<span class="n">plot_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;h5&quot;</span> <span class="p">:</span> <span class="s2">&quot;west.h5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                <span class="s2">&quot;plot_mode&quot;</span> <span class="p">:</span> <span class="s2">&quot;contour_f&quot;</span><span class="p">,</span>
                <span class="s2">&quot;contour_interval&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;Xname&quot;</span> <span class="p">:</span> <span class="s2">&quot;pcoord&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Yname&quot;</span> <span class="p">:</span> <span class="s2">&quot;RoG&quot;</span><span class="p">,</span>
                <span class="s2">&quot;jointplot&quot;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;p_units&quot;</span> <span class="p">:</span> <span class="s2">&quot;kcal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;p_max&quot;</span> <span class="p">:</span> <span class="mf">17.5</span><span class="p">,</span>
                <span class="c1">#&quot;smoothing_level&quot; : 1,</span>
                <span class="c1"># the input plot_options kwarg dict is also parsed for matplotlib formatting keywords</span>
                <span class="s2">&quot;xlabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Heavy Atom RMSD ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ylabel&quot;</span> <span class="p">:</span> <span class="s2">&quot;Radius of Gyration ($\AA$)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;histrange_x&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                <span class="s2">&quot;histrange_y&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mf">20.5</span><span class="p">),</span>
                <span class="c1">#&quot;grid&quot; : True,</span>
                <span class="c1">#&quot;color&quot; : &quot;k&quot;,</span>
                <span class="p">}</span>
<span class="c1"># change size since joint plots take more space</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">wedap_obj</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="o">**</span><span class="n">plot_options</span><span class="p">)</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;-RT ln P (kcal mol$^{-1}$)&quot;</span><span class="p">)</span>

<span class="c1">#wedap_obj.plot_trace((5.5, 19.5), ax=wedap_obj.ax, linewidth=0.5, find_iter_seg=True)</span>
<span class="c1">#wedap_obj.plot_trace((200, 20), ax=wedap_obj.ax, color=&quot;snow&quot;, linewidth=0.5)</span>

<span class="c1"># save the resulting figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;toc.pdf&quot;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e357d13f200e46a2a38fdde4fd1c22d5", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_95_1.png" src="../_images/paper_figures_paper_figures_95_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[90]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plt.rcParams[&quot;figure.figsize&quot;] = (4.5,3)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">3.8</span><span class="p">)</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">wedap_obj</span> <span class="o">=</span> <span class="n">wedap</span><span class="o">.</span><span class="n">H5_Plot</span><span class="p">(</span><span class="n">h5</span><span class="o">=</span><span class="s2">&quot;../notebook/p53.h5&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;evolution&quot;</span><span class="p">)</span>
    <span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">wedap_obj</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">((</span><span class="mf">4.2</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">find_iter_seg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Progress Coordinate&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Weighted Ensemble Iteration&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;-ln P(x)&quot;</span><span class="p">)</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">cbar</span><span class="o">.</span><span class="n">frac</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">wedap_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;toc2.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d84224988d3445a4a72cdcd522ce499c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/paper_figures_paper_figures_96_1.png" src="../_images/paper_figures_paper_figures_96_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../notebook/wedap_demo.html" class="btn btn-neutral float-left" title="WEDAP Demo" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Darian Yang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>